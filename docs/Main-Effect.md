# Explanation of the Standard ALE Algorithm and Thresholding Techniques

---

## **Standard ALE Algorithm**

The Activation Likelihood Estimation (ALE) algorithm is a meta-analytic approach used to synthesize findings from neuroimaging studies. It identifies regions of convergence across experiments by modeling reported activation coordinates as spatial probability distributions.

### **Steps of the Standard ALE Algorithm**:
1. **Modeling Spatial Uncertainty**:
   - Each activation focus (coordinate) from included studies is modeled as a 3D Gaussian distribution to account for spatial uncertainty.
   - The size of the Gaussian depends on the sample size of the study.

2. **Combining Distributions**:
   - Probability distributions from all foci in an experiment are combined to create a **modeled activation (MA) map** for that experiment.

3. **Computing ALE Scores**:
   - MA maps from all experiments are combined to compute voxel-wise ALE scores, representing the likelihood of finding a true activation at each voxel.

4. **Computing Test Statistics (p, z, and TFCE values)**:
   - Non-linear histogram integration is used to analytically create a null-distribution of ALE values. 

5. **Permutation Testing for Multiple Comparison Correction**:
   - A null distribution is generated by randomly shuffling the foci across experiments and calculating ALEs for these "null experiments".
   - ALE/Z/TFCE scores from the actual data are compared to this null distribution to determine statistical significance.

---

## **Thresholding Techniques**

After computing ALE maps, thresholding methods are applied to control for multiple comparisons and identify statistically significant results. The three main thresholding techniques are **voxel-level FWE (vFWE)**, **cluster-level FWE (cFWE)**, and **threshold-free cluster enhancement (TFCE)**.

---

### **1. Voxel-Level FWE (vFWE)**

- **Description**:
  - Controls the family-wise error (FWE) rate by directly testing each voxel.
  - A permutation-based null distribution of maximum ALE scores is generated, and voxels exceeding the 95th percentile are deemed significant.

- **Strengths**:
  - High spatial specificity.
  - Ideal for detecting highly localized activations.

- **Limitations**:
  - Very conservative; small clusters or weak signals are often missed.

---

### **2. Cluster-Level FWE (cFWE)**

- **Description**:
  - Combines voxel-wise thresholds with cluster size information.
  - Voxels are first thresholded at a cluster-forming threshold (e.g., p < 0.001), and the size of the resulting clusters is compared to a null distribution of cluster sizes.

- **Strengths**:
  - Balances spatial specificity and sensitivity.
  - Detects larger activation patterns more effectively than vFWE.

- **Limitations**:
  - Smaller clusters can be missed if they do not meet the size threshold.

- **Recommendation**:
  - **cFWE is the default recommendation** for ALE analyses, offering a robust balance between sensitivity and interpretability.

---

### **3. Threshold-Free Cluster Enhancement (TFCE)**

- **Description**:
  - Enhances raw ALE maps by combining voxel intensities and cluster sizes without requiring a cluster-forming threshold.
  - Uses a continuous range of cluster-forming thresholds to calculate voxel-wise significance.

- **Strengths**:
  - High sensitivity, especially for extended regions of activation.
  - Can detect smaller effects that do not form distinct clusters.

- **Limitations**:
  - Computationally intensive.
  - Does not consistently outperform cFWE in ALE settings.

- **Evaluation**:
  - TFCE performed well in sensitivity tests but did not show significant advantages over cFWE for ALE analyses. It is not recommended as the default due to its high computational cost and marginal benefits.

---

## **Comparison of Thresholding Techniques**

| **Metric**              | **vFWE**            | **cFWE**                  | **TFCE**                  |
|--------------------------|---------------------|----------------------------|---------------------------|
| **Spatial Specificity**  | High               | Moderate                  | Moderate                  |
| **Sensitivity**          | Low                | High                      | High                      |
| **Cluster Detection**    | Detects small clusters | Detects large clusters   | Detects extended regions   |
| **Computational Cost**   | Low                | Moderate                  | High                      |

---

## **Recommendation**

Based on sensitivity, computational efficiency, and robustness:
- **Cluster-Level FWE (cFWE)** is recommended as the **default method** for thresholding in ALE analyses.
- Use **TFCE** only if the detection of small or subtle effects is critical, and computational resources are not a constraint.